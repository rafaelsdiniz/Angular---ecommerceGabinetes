<div class="page-container">
  <div class="form-container">

    <!-- Header -->
    <div class="form-header">
      <button mat-icon-button class="back-btn" (click)="cancelar()">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <h2 class="form-title">{{ isEdicao ? "Editar Gabinete" : "Novo Gabinete" }}</h2>
    </div>

    <!-- Loading State -->
    <div *ngIf="carregando" class="loading-state">
      <mat-spinner diameter="48"></mat-spinner>
      <p>Carregando...</p>
    </div>

    <!-- Form -->
    <div *ngIf="!carregando" class="form-card">
      <form (ngSubmit)="salvar()" #gabineteForm="ngForm" novalidate>

        <!-- ===== IMAGEM (URL) ===== -->
        <div class="form-section">
          <h3 class="section-title">Imagem do Gabinete (URL)</h3>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>URL da Imagem</mat-label>
            <input
              matInput
              type="url"
              [(ngModel)]="gabinete.imagemUrl"
              name="imagemUrl"
              placeholder="https://exemplo.com/imagem.jpg" />
            <mat-icon matPrefix>link</mat-icon>
          </mat-form-field>

          <div class="image-preview" *ngIf="gabinete.imagemUrl">
            <img [src]="gabinete.imagemUrl" [alt]="gabinete.nomeExibicao" />
            <button type="button" class="remove-btn" (click)="removerImagem()">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>

        <!-- ===== INFORMAÇÕES BÁSICAS ===== -->
        <div class="form-section">
          <h3 class="section-title">Informações Básicas</h3>
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Nome de Exibição</mat-label>
            <input matInput type="text" [(ngModel)]="gabinete.nomeExibicao" name="nomeExibicao" required />
            <mat-icon matPrefix>computer</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Marca</mat-label>
            <input matInput type="text" [(ngModel)]="gabinete.marca" name="marca" required />
            <mat-icon matPrefix>business</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Preço</mat-label>
            <input matInput type="number" [(ngModel)]="gabinete.preco" name="preco" required min="0" step="0.01" />
            <mat-icon matPrefix>attach_money</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Cor</mat-label>
            <input matInput type="text" [(ngModel)]="gabinete.cor" name="cor" required />
            <mat-icon matPrefix>palette</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Formato</mat-label>
            <input matInput type="text" [(ngModel)]="gabinete.formato" name="formato" />
            <mat-icon matPrefix>view_in_ar</mat-icon>
          </mat-form-field>
        </div>

        <!-- ===== DIMENSÕES E PESO ===== -->
        <div class="form-section">
          <h3 class="section-title">Dimensões e Peso</h3>
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Altura (mm)</mat-label>
            <input matInput type="number" [(ngModel)]="gabinete.altura" name="altura" min="0" />
            <mat-icon matPrefix>height</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Largura (mm)</mat-label>
            <input matInput type="number" [(ngModel)]="gabinete.largura" name="largura" min="0" />
            <mat-icon matPrefix>straighten</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Peso (kg)</mat-label>
            <input matInput type="number" [(ngModel)]="gabinete.peso" name="peso" min="0" step="0.1" />
            <mat-icon matPrefix>scale</mat-icon>
          </mat-form-field>
        </div>

        <!-- ===== OUTROS CAMPOS ===== -->
        <div class="form-section">
          <h3 class="section-title">Outras Informações</h3>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Descrição</mat-label>
            <textarea matInput [(ngModel)]="gabinete.descricao" name="descricao" rows="4"></textarea>
            <mat-icon matPrefix>notes</mat-icon>
          </mat-form-field>
        </div>

        <!-- ===== ERRO ===== -->
        <div *ngIf="erro" class="error-alert">
          <mat-icon>error_outline</mat-icon>
          <span>{{ erro }}</span>
        </div>

        <!-- ===== AÇÕES ===== -->
        <div class="form-actions">
          <button mat-stroked-button type="button" class="cancel-btn" (click)="cancelar()" [disabled]="salvando">
            Cancelar
          </button>
          <button mat-flat-button type="submit" class="save-btn" [disabled]="salvando">
            <mat-spinner *ngIf="salvando" diameter="20" class="btn-spinner"></mat-spinner>
            <span *ngIf="!salvando">{{ isEdicao ? "Salvar" : "Criar" }}</span>
            <span *ngIf="salvando">Salvando...</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
